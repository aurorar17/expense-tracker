<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Info</title>

    <link rel="stylesheet" href="./user-info.css" />
    <link rel="stylesheet" href="/styles/global.css" />
    <link rel="stylesheet" href="/styles/desktop.css" />
    <link rel="stylesheet" href="/styles/mobile.css" />
  </head>

  <body>
    <div class="wrap">
      <header>
        <script src="/classes/Header.js"></script>
      </header>

      <!-- User Dashboard -->

      <main class="user-container">
        <div>
          <!--da qui 1-->
          <div id="nav-2">
            <div class="menu">
              <a href="#" id="userInfoLink">
                <svg
                  width="28"
                  height="24"
                  viewBox="0 0 28 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M5 1.5H23C24.933 1.5 26.5 3.067 26.5 5V15C26.5 16.933 24.933 18.5 23 18.5H15.0949C14.5811 18.5 14.0692 18.5609 13.5697 18.6815L2.11732 21.4458C1.80275 21.5218 1.5 21.2834 1.5 20.9598V5C1.5 3.067 3.067 1.5 5 1.5Z"
                    stroke="#CCC3DC"
                    stroke-width="3"
                  />
                  <circle
                    cx="8.78571"
                    cy="7.78571"
                    r="0.785714"
                    fill="#5A1CDF"
                  />
                  <path
                    d="M11.9286 7.78571H19"
                    stroke="#5A1CDF"
                    stroke-linecap="round"
                  />
                </svg>
                <h3 class="active user-info-h3">User Information</h3>
              </a>
            </div>

            <!--da qui 2-->
            <div class="menu">
              <a href="#" id="bankInformationLink">
                <svg
                  width="28"
                  height="24"
                  viewBox="0 0 28 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M5 1.5H23C24.933 1.5 26.5 3.067 26.5 5V15C26.5 16.933 24.933 18.5 23 18.5H15.0949C14.5811 18.5 14.0692 18.5609 13.5697 18.6815L2.11732 21.4458C1.80275 21.5218 1.5 21.2834 1.5 20.9598V5C1.5 3.067 3.067 1.5 5 1.5Z"
                    stroke="#CCC3DC"
                    stroke-width="3"
                  />
                  <circle
                    cx="8.78571"
                    cy="7.78571"
                    r="0.785714"
                    fill="#5A1CDF"
                  />
                  <path
                    d="M11.9286 7.78571H19"
                    stroke="#5A1CDF"
                    stroke-linecap="round"
                  />
                </svg>
                <h3 class="active user-info-h3">User Summary</h3>
              </a>
            </div>
          </div>
        </div>

        <section class="user-dashboard">
          <div id="userInfoSection">
            <table style="margin-bottom: 30px">
              <h4>User Information:</h4>
              <tbody>
                <tr>
                  <th>Name</th>
                  <td id="fname" onclick="editField('fname')"></td>
                </tr>
                <tr>
                  <th>Surname</th>
                  <td id="lname"></td>
                </tr>
                <tr>
                  <th>Email</th>
                  <td id="email"></td>
                </tr>
                <tr>
                  <th>Phone number</th>
                  <td id="phone">N/A</td>
                </tr>
              </tbody>
            </table>
            <h4>Privacy:</h4>
            <table>
              <tbody>
                <tr>
                  <th>Data Usage Consent</th>
                  <td data-label="Data Usage Consent">
                    Accepted
                    <img
                      src="https://img.icons8.com/material-outlined/16/000000/info.png"
                      class="info-icon"
                      onclick="toggleDefinition(this)"
                    />
                    <div class="definition">
                      User agrees to the use of their data for specified
                      purposes.
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>Data Sharing with Third Parties</th>
                  <td data-label="Data Sharing with Third Parties">
                    Not Allowed
                    <img
                      src="https://img.icons8.com/material-outlined/16/000000/info.png"
                      class="info-icon"
                      onclick="toggleDefinition(this)"
                    />
                    <div class="definition">
                      User does not permit sharing of personal data with third
                      parties. Lorem ipsum dolor sit amet, consectetur
                      adipisicing elit. Accusantium atque natus impedit, enim
                      numquam ratione, fugiat odit a illum voluptatum
                      reprehenderit tempora totam et quibusdam, nemo similique
                      dignissimos quo culpa.
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>Marketing Preferences</th>
                  <td data-label="Marketing Preferences">
                    Newsletter Enabled
                    <img
                      src="https://img.icons8.com/material-outlined/16/000000/info.png"
                      class="info-icon"
                      onclick="toggleDefinition(this)"
                    />
                    <div class="definition">
                      User has opted in to receive marketing communications.
                      Lorem ipsum, dolor sit amet consectetur adipisicing elit.
                      Magnam in aspernatur ullam. Similique, doloribus
                      assumenda. Modi quis qui ratione, sunt optio temporibus
                      asperiores similique perferendis fugiat, voluptatum veniam
                      atque minus!
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>Tracking and Cookies</th>
                  <td data-label="Tracking and Cookies">
                    Enabled
                    <img
                      src="https://img.icons8.com/material-outlined/16/000000/info.png"
                      class="info-icon"
                      onclick="toggleDefinition(this)"
                    />
                    <div class="definition">
                      User allows the use of tracking technologies and cookies.
                    </div>
                  </td>
                </tr>
                <tr>
                  <th>Data Deletion Request</th>
                  <td data-label="Data Deletion Request">
                    Not Requested
                    <img
                      src="https://img.icons8.com/material-outlined/16/000000/info.png"
                      class="info-icon"
                      onclick="toggleDefinition(this)"
                    />
                    <div class="definition">
                      User has not submitted a request for data deletion. Lorem
                      ipsum dolor sit amet, consectetur adipisicing elit. Quod
                      excepturi, mollitia animi, beatae saepe dolores deserunt,
                      illum quis quidem officiis quisquam iure velit nihil
                      repellat necessitatibus perferendis tempora totam error!
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div id="bankInformationSection" style="display: none">
            <table id="categoryTable">
              <thead>
                <tr>
                  <th>Number</th>
                  <th>Category</th>
                  <th>Description</th>
                  <th style="background-color: blueviolet">Limit</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>
      </main>
    </div>

    <script>
      document.getElementById("userInfoSection").style.display = "block";
      document.getElementById("bankInformationSection").style.display = "none";

      document
        .getElementById("bankInformationLink")
        .addEventListener("click", function (event) {
          event.preventDefault();
          document.getElementById("userInfoSection").style.display = "none";
          document.getElementById("bankInformationSection").style.display =
            "block";
        });

      document
        .getElementById("userInfoLink")
        .addEventListener("click", function (event) {
          event.preventDefault();
          document.getElementById("bankInformationSection").style.display =
            "none";
          document.getElementById("userInfoSection").style.display = "block";
        });

      function editField(fieldId) {
        const cell = document.getElementById(fieldId);
        const currentValue = cell.textContent;
        const input = document.createElement("input");

        input.value = currentValue;

        cell.innerHTML = "";
        cell.appendChild(input);
        input.focus();

        input.onblur = function () {
          const newValue = input.value;
          cell.textContent = newValue;
          saveUserData(fieldId, newValue);
        };
        input.onkeypress = function (e) {
          if (e.key === "Enter") {
            input.blur();
          }
        };
      }
      function saveUserData(fieldId, value) {
        const user = JSON.parse(localStorage.getItem("user")) || {};
        user[fieldId] = value;
        localStorage.setItem("user", JSON.stringify(user));
      }

      function toggleDefinition(icon) {
        const definition = icon.parentElement.querySelector(".definition");
        if (
          definition.style.display === "none" ||
          definition.style.display === ""
        ) {
          definition.style.display = "block";
        } else {
          definition.style.display = "none";
        }
      }
    </script>
  </body>

  <script src="/functions/user-function.js"></script>
  <script src="/utils/loadFile.js"></script>
</html>
